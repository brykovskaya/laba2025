## ‚ö°–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ concurrency
### ü¶â–£–ø—Ä–∞–∂–Ω–µ–Ω–∏—è  - –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∏ 

#### 1. –†–∞–∑–Ω—ã–µ —É—Ä–æ–≤–Ω–∏ –∏–∑–æ–ª—è—Ü–∏–∏
–°–æ–∑–¥–∞–π—Ç–µ –¥–≤–µ —Å–µ—Å—Å–∏–∏ PostgreSQL –∏ –Ω–∞—á–Ω–∏—Ç–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –≤ –∫–∞–∂–¥–æ–π. –í –ø–µ—Ä–≤–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∏–∑–º–µ–Ω–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ —Ç–∞–±–ª–∏—Ü–µ, –Ω–æ –Ω–µ —Ñ–∏–∫—Å–∏—Ä—É–π—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è. –í–æ –≤—Ç–æ—Ä–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø—Ä–æ—á–∏—Ç–∞—Ç—å —ç—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ –ø—Ä–∏ —Ä–∞–∑–Ω—ã—Ö —É—Ä–æ–≤–Ω—è—Ö –∏–∑–æ–ª—è—Ü–∏–∏. –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç?

–∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç–∞–±–ª–∏—Ü—É products
![](../images/07_01.png)<br>


–∑–∞–ø—É—Å–∫–∞–µ–º –ø–µ—Ä–≤—É—é —Å–µ—Å—Å–∏—é –∏ –≤–Ω–æ—Å–∏–º –∏–∑–º–µ–Ω–µ–Ω–∏–µ –≤ –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ —Å id = 1. –Ω–µ —Ñ–∏–∫—Å–∏—Ä—É–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è

![](../images/07_02.png)<br>

–∑–∞–ø—É—Å–∫–∞–µ–º –≤—Ç–æ—Ä—É—é —Å–µ—Å—Å–∏—é –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –∏ –ø–æ–ø—Ä–æ–±—É–µ–º –ø—Ä–æ—á–∏—Ç–∞—Ç—å —ç—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ –ø—Ä–∏ —Ä–∞–∑–Ω—ã—Ö —É—Ä–æ–≤–Ω—è—Ö –∏–∑–æ–ª—è—Ü–∏–∏.

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é, –≤ PostgreSQL  –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —É—Ä–æ–≤–µ–Ω—å –∏–∑–æ–ª—è—Ü–∏–∏ `READ COMMITTED`.  
–ü–æ—ç—Ç–æ–º—É –≤—ã–≤–æ–¥ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∑–∞–ø—Ä–æ—Å–∞ –∏ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∑–∞–ø—Ä–æ—Å–∞ —Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º —É—Ä–æ–≤–Ω–µ–º –∏–∑–æ–ª—è—Ü–∏–∏ read commited –Ω–µ –æ—Ç–ª–∏—á–∞—é—Ç—Å—è.
![](../images/07_03.png)<br>

![](../images/07_04.png)<br>

 –£—Å—Ç–∞–Ω–æ–≤–∫–∞ serialized:
![](../images/07_05.png)<br>
—Ç–µ–ø–µ—Ä—å –≤ –ø–µ—Ä–≤–æ–π —Å–µ—Å—Å–∏–∏ –∑–∞—Ñ–∏–∫—Å–∏—Ä—É–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥–æ–π commit 
![](../images/07_06.png)<br>
–ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ –ø–µ—Ä–µ–π–¥–µ–º –∫–æ –≤—Ç–æ—Ä–æ–π —Å–µ—Å—Å–∏–∏ –∏ –ø–æ—Å–º–æ—Ç—Ä–∏–º —á—Ç–æ –±—É–¥–µ—Ç –≤ –≤—ã–≤–æ–¥–µ –∑–∞–ø—Ä–æ—Å–∞
![](../images/07_07.png)<br>

–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –ø–æ–º–µ–Ω—è–ª–æ—Å—å.

####  2.	–ê–Ω–∞–ª–∏–∑ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ —Å –ø–æ–º–æ—â—å—é pg_locks
–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ pg_locks –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫, –≤–æ–∑–Ω–∏–∫–∞—é—â–∏—Ö –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π (—á—Ç–µ–Ω–∏–µ, –∑–∞–ø–∏—Å—å, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ) –≤ —Ä–∞–∑–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è—Ö.

![](../images/07_08.png)<br>

#### 3.deadlock 
–ù–∞–ø–∏—à–∏—Ç–µ –∑–∞–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ deadlock. –ò–∑—É—á–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ –∏ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –ø—Ä–∏—á–∏–Ω—É –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏—è deadlock
![](../images/07_09.png)<br>
![](../images/07_10.png)<br>
![](../images/07_11.png)<br>
![](../images/07_12.png)<br>