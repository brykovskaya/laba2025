## ü¶∏ –ú–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö ü¶∏
### üñß –£–ø—Ä.1 - ER-–¥–∏–∞–≥—Ä–∞–º–º–∞ –¥–ª—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–∞, –∏—Å–ø–æ–ª—å–∑—É—è —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—É—é –º–æ–¥–µ–ª—å.

ER (–¥–∏–∞–≥—Ä–∞–º–º—ã "—Å—É—â–Ω–æ—Å—Ç—å-—Å–≤—è–∑—å")
https://app.diagrams.net/
–ù–∞—Ä–∏—Å–æ–≤–∞—Ç—å –ø–æ –æ–ø–∏—Å–∞–Ω–∏—é

–ù–∏–∂–µ –ø—Ä–∏–≤–µ–¥–µ–Ω —Ç–µ–∫—Å—Ç–æ–≤—ã–π –ø—Ä–∏–º–µ—Ä ER-–¥–∏–∞–≥—Ä–∞–º–º—ã, –æ–ø–∏—Å—ã–≤–∞—é—â–∏–π —Ç–∏–ø–∏—á–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏ –¥–ª—è –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–∞.
 
### –°—É—â–Ω–æ—Å—Ç–∏ –∏ –∏—Ö –∞—Ç—Ä–∏–±—É—Ç—ã¬∂

#### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (User)
 - UserID (Primary Key)
 - UserName
 - Email
 - Password
 - FirstName
 - LastName
 - PhoneNumber
 - AddressID (Foreign Key)
 - –ê–¥—Ä–µ—Å (Address)
 - AddressID (Primary Key)
 - Street
 - City
 - State
 - PostalCode
 - Country

#### –¢–æ–≤–∞—Ä (Product)
 - ProductID (Primary Key)
 - Name
 - Description
 - Price
 - StockQuantity
 - CategoryID (Foreign Key)
 - –ö–∞—Ç–µ–≥–æ—Ä–∏—è (Category)
 - CategoryID (Primary Key)
 - CategoryName
 - Description

#### –ó–∞–∫–∞–∑ (Order)
 - OrderID (Primary Key)
 - UserID (Foreign Key)
 - OrderDate
 - TotalAmount
 - Status

#### –ó–∞–∫–∞–∑–∞–Ω–Ω—ã–π —Ç–æ–≤–∞—Ä (OrderItem)
 - OrderItemID (Primary Key)
 - OrderID (Foreign Key)
 - ProductID (Foreign Key)
 - Quantity
 - Price

#### –û–ø–ª–∞—Ç–∞ (Payment)
 - PaymentID (Primary Key)
 - OrderID (Foreign Key)
 - PaymentDate
 - Amount
 - PaymentMethod

#### –°–≤—è–∑–∏ –º–µ–∂–¥—É —Å—É—â–Ω–æ—Å—Ç—è–º–∏
 -–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (User) –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –æ–¥–∏–Ω –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ê–¥—Ä–µ—Å–æ–≤ (Address) (1:N).
 -–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (User) –º–æ–∂–µ—Ç —Å–¥–µ–ª–∞—Ç—å –æ–¥–∏–Ω –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ó–∞–∫–∞–∑–æ–≤ (Order) (1:N).
 -–ó–∞–∫–∞–∑ (Order) –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –æ–¥–∏–Ω –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ó–∞–∫–∞–∑–∞–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ (OrderItem) (1:N).
 -–¢–æ–≤–∞—Ä (Product) –º–æ–∂–µ—Ç –±—ã—Ç—å —á–∞—Å—Ç—å—é –æ–¥–Ω–æ–≥–æ –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ó–∞–∫–∞–∑–∞–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ (OrderItem) (1:N).
 -–¢–æ–≤–∞—Ä (Product) –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –æ–¥–Ω–æ–π –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ (Category) (N:1).
 -–ó–∞–∫–∞–∑ (Order) –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –æ–¥–Ω—É –û–ø–ª–∞—Ç—É (Payment) (1:1).

#### –¢–µ–∫—Å—Ç–æ–≤–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ ER-–¥–∏–∞–≥—Ä–∞–º–º—ã

[User] --1:N--> [Order] --1:N--> [OrderItem] --N:1--> [Product] --N:1--> [Category] | | | | | | | | | | | | +--1:N--> [Address] +--1:1--> [Payment] | | +-------------+ | | [PaymentMethod]



#### –û–ø–∏—Å–∞–Ω–∏–µ —Å–≤—è–∑–∏
 - User - Address: –û–¥–∏–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∞–¥—Ä–µ—Å–æ–≤.
 - User - Order: –û–¥–∏–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —Å–¥–µ–ª–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–∫–∞–∑–æ–≤.
 - Order - OrderItem: –û–¥–∏–Ω –∑–∞–∫–∞–∑ –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–æ–≤–∞—Ä–æ–≤.
 - OrderItem - Product: –ö–∞–∂–¥—ã–π –∑–∞–∫–∞–∑–∞–Ω–Ω—ã–π —Ç–æ–≤–∞—Ä –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ –æ–¥–Ω–æ–º—É –ø—Ä–æ–¥—É–∫—Ç—É.
 - Product - Category: –ö–∞–∂–¥—ã–π –ø—Ä–æ–¥—É–∫—Ç –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –æ–¥–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏.
 - Order - Payment: –û–¥–∏–Ω –∑–∞–∫–∞–∑ –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –æ–¥–Ω—É –æ–ø–ª–∞—Ç—É.
 

## –†–µ—à–µ–Ω–∏–µ

 —Å–∫—Ä–∏–ø—Ç —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü [ecom_create.sql](../files/ecom_create.sql)
 ![](../images/01_02_01.png)
 
–ó–∞–ø–æ–ª–Ω–∏–º –¥–∏–∞–≥—Ä–∞–º–º—É –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–¥–∞ SQL—é
 ![](../images/01_02_02.png)
 ![](../images/01_02_03.png)

draw.io. –ü–æ–∑–≤–æ–ª—è–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–≤–∞—Ç—å –¥–∏–∞–≥—Ä–∞–º–º—ã –∏–∑ –∫–æ–¥–∞ SQL. –ö–æ–¥ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç—Å—è –≤ —Å—É—â–Ω–æ—Å—Ç–∏, —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ –≤—Å–µ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–µ –≤ –Ω—ë–º –∞—Ç—Ä–∏–±—É—Ç—ã. –ó–∞—Ç–µ–º –Ω—É–∂–Ω–æ –ø–µ—Ä–µ—Ä–∞—Å–ø–æ–ª–æ–∂–∏—Ç—å –∏ —Å–æ–µ–¥–∏–Ω–∏—Ç—å —ç—Ç–∏ —Å—É—â–Ω–æ—Å—Ç–∏.

–í –º–æ–µ–º —Å–ª—É—á–∞–µ –ø–æ—Ç—Ä–µ–±–æ–≤–∞–ª–∞—Å—å –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞, –Ω–æ –æ—Å–Ω–æ–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –±—ã–ª–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã. –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º —Ç–æ —á—Ç–æ –∑–∞–≥—Ä—É–∑–∏–ª–æ—Å—å, –¥–æ–±–∞–≤–∏–º —Å–≤—è–∑–∏.

 ![](../images/01_02_04.png)
 
### üñß  –£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ 2: –ú–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è Online-–º–∞–≥–∞–∑–∏–Ω–∞

 - –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ —Ñ–∞–∫—Ç—ã –∏ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ –¥–ª—è –≤–∞—à–µ–≥–æ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–∞.
 - –°–æ–∑–¥–∞–π—Ç–µ ER-–¥–∏–∞–≥—Ä–∞–º–º—É, –∏—Å–ø–æ–ª—å–∑—É—è –≤—ã–±—Ä–∞–Ω–Ω—É—é –≤–∞–º–∏ —Å—Ö–µ–º—É (–∑–≤–µ–∑–¥–∞, —Å–Ω–µ–∂–∏–Ω–∫–∞ –∏–ª–∏ Data Vault).
 - –û–ø–∏—à–∏—Ç–µ, –∫–∞–∫ –±—ã –≤—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞–ª–∏ —ç—Ç—É –º–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö –≤ —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–π –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.
 - –ù–∞–ø–∏—à–∏—Ç–µ SQL-–∑–∞–ø—Ä–æ—Å –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ–±—â–µ–≥–æ –æ–±—ä–µ–º–∞ –ø—Ä–æ–¥–∞–∂ –ø–æ –º–µ—Å—è—Ü–∞–º, –∏—Å–ø–æ–ª—å–∑—É—è —Å–æ–∑–¥–∞–Ω–Ω—É—é –≤–∞–º–∏ —Å—Ö–µ–º—É.

## –†–µ—à–µ–Ω–∏–µ

–∏—Å–ø–æ–ª—å–∑—É–µ–º ER –¥–∏–∞–≥—Ä–∞–º–º—É –∏–∑ –ø—Ä–æ—à–ª–æ–≥–æ —É—Ä–æ–∫–∞.

–î–æ—Ä–∞–±–æ—Ç–∞–ª–∏ –¥–∏–∞–≥—Ä–∞–º–º—É, —á—Ç–æ–±—ã –≤—ã–¥–µ–ª–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É —Ñ–∞–∫—Ç–æ–≤ –∏ —Ç–∞–±–ª–∏—Ü—ã —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–µ–π - –¥–ª—è —ç—Ç–æ–≥–æ –±—ã–ª–æ –∏–∑–º–µ–Ω–µ–Ω–æ –º–µ—Å—Ç–æ—Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü.–ß—Ç–æ —É–ª—É—á—à–∏–ª–æ —á–∏—Ç–∞–µ–º–æ—Å—Ç—å –∏ –ø–æ–Ω–∏–º–∞–Ω–∏–µ.

–¢–∞–±–ª–∏—Ü–∞ —Ñ–∞–∫—Ç–æ–≤ - orders

–¢–∞–±–ª–∏—Ü—ã —Ä–∞–∑–º–µ—Ä–æ–Ω–æ—Å—Ç–µ–π - Address, Category,  Dates, Users, Product,  Payment, OrderItem

—Å—Ö–µ–º–∞  —Å–Ω–µ–∂–∏–Ω–∫–∞

 ![](../images/01_02_05.png)
 
SQL –∑–∞–ø—Ä–æ—Å  –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ–±—â–µ–≥–æ –æ–±—ä–µ–º–∞ –ø—Ä–æ–¥–∞–∂ –ø–æ –º–µ—Å—è—Ü–∞–º –º–æ–≥ –±—ã –≤—ã–≥–ª—è–¥–µ—Ç—å —Ç–∞–∫:

–ï—Å–ª–∏ —Å—á–∏—Ç–∞—Ç—å –ø—Ä–æ–¥–∞–∂–∏ –ø–æ —Ç–∞–±–ª–∏—Ü–µ Orders
```
SELECT d.month AS month_sales,
SUM(o.totalamount)  AS total_sales
FROM orders o 
LEFT JOIN dates AS d ON o.dateid=d.dateid
GROUP BY d.month
ORDER BY d.month;
```

–ï—Å–ª–∏ —Å—á–∏—Ç–∞—Ç—å –ø—Ä–æ–¥–∞–∂–∏ –ø–æ —Ç–∞–±–ª–∏—Ü–µ Payment
```
SELECT date_trunc('month', CAST(p.paymentdate AS DATE)) AS month,
SUM(p.amount)  AS total_sales
FROM payment AS p
GROUP BY month
ORDER BY month;
```